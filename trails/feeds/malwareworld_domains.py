#!/usr/bin/env python

import os, json

#from core.common import retrieve_content

__url__ = "https://malwareworld.com/textlists/domains.txt"
__check__ = ""
__info__ = ""
__reference__ = ""

def fetch():
  retval = {}
  content = os.popen('curl '+__url__).read()

  domains_json = json.loads(content)
  for domain in domains_json.keys():
    info = "/".join(domains_json[domain]["type"])+" ("+domains_json[domain]["title"]+")"
    reference = "  ".join(domains_json[domain]["references"])
    retval[domain] = (info,reference)

  return retval
